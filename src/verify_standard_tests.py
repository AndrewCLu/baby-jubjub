from baby_jubjub import TwEdPoint

# Verify the tests from the Baby Jubjub standard: https://eips.ethereum.org/EIPS/eip-2494
def main():
    print("Verifying standard tests for the Baby Jubjub curve...")
    # Test 1: Addition
    x1 = 17777552123799933955779906779655732241715742912184938656739573121738514868268
    y1 = 2626589144620713026669568689430873010625803728049924121243784502389097019475
    x2 = 16540640123574156134436876038791482806971768689494387082833631921987005038935
    y2 = 20819045374670962167435360035096875258406992893633759881276124905556507972311
    x3 = 7916061937171219682591368294088513039687205273691143098332585753343424131937
    y3 = 14035240266687799601661095864649209771790948434046947201833777492504781204499

    assert(TwEdPoint(x1, y1) + TwEdPoint(x2, y2) == TwEdPoint(x3, y3))

    # Test 2: Doubling
    x1 = 17777552123799933955779906779655732241715742912184938656739573121738514868268
    y1 = 2626589144620713026669568689430873010625803728049924121243784502389097019475
    x2 = 17777552123799933955779906779655732241715742912184938656739573121738514868268
    y2 = 2626589144620713026669568689430873010625803728049924121243784502389097019475
    x3 = 6890855772600357754907169075114257697580319025794532037257385534741338397365
    y3 = 4338620300185947561074059802482547481416142213883829469920100239455078257889

    assert(TwEdPoint(x1, y1) + TwEdPoint(x2, y2) == TwEdPoint(x3, y3))

    # Test 3: Doubling the identity
    x1 = 0
    y1 = 1
    x2 = 0
    y2 = 1
    x3 = 0
    y3 = 1

    assert(TwEdPoint(x1, y1) + TwEdPoint(x2, y2) == TwEdPoint(x3, y3))

    # Test 4: Curve membership
    assert(TwEdPoint(0, 1).is_on_curve())
    try:
        TwEdPoint(1, 0)
        assert(False)
    except ValueError:
        pass

    # Test 5: Base point    
    assert(TwEdPoint.base() == TwEdPoint.generator().scalar_mul(8))

    # Test 6: Base point order
    l = 2736030358979909402780800718157159386076813972158567259200215660948447373041
    assert(TwEdPoint.base().scalar_mul(l).is_infinity())

    print("Standard tests verified!")

if __name__ == '__main__':
    main()
